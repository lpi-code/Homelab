# Production Environment Ansible Configuration
# This configuration is specific to the prod environment

[defaults]
# Use dynamic inventory script with prod environment
inventory = $SHARED_DIR_PATH/ansible/inventory/dynamic_inventory.py

# Host key checking
host_key_checking = False

# SSH configuration
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no
pipelining = True
timeout = 30

# Output configuration
stdout_callback = yaml
bin_ansible_callbacks = True

# Logging
#log_path = ./ansible.log
display_skipped_hosts = False
display_ok_hosts = True

# Performance settings (optimized for prod)
forks = 10
gathering = smart
fact_caching = memory
fact_caching_timeout = 86400

# Role and collection paths
roles_path = $SHARED_DIR_PATH/ansible/roles:ansible/roles
collections_path = $SHARED_DIR_PATH/ansible/collections
playbook_dir = $SHARED_DIR_PATH/ansible/playbooks

# Variable precedence
vars_plugins_enabled = host_group_vars
variable_precedence = inventory_dir, inventory_file, inventory_script, inventory_dir_plugins, playbook_dir, playbook_dir_plugins

# Environment-specific settings
[inventory:$SHARED_DIR_PATH/ansible/inventory/dynamic_inventory.py]
# Dynamic inventory script settings
env_var = ANSIBLE_INVENTORY_ENV
debug_var = ANSIBLE_DEBUG

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False

[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no
pipelining = True
control_path = /tmp/ansible-ssh-prod-%%h-%%p-%%r
retries = 3

[galaxy]
server_list = galaxy, galaxy_community
roles_path = $SHARED_DIR_PATH/ansible/roles
collections_path = $SHARED_DIR_PATH/ansible/collections

[colors]
highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

# Plugin configuration
[callback_plugins]
callback_plugins = $SHARED_DIR_PATH/ansible/plugins/callback

[filter_plugins]
filter_plugins = $SHARED_DIR_PATH/ansible/plugins/filter

[lookup_plugins]
lookup_plugins = $SHARED_DIR_PATH/ansible/plugins/lookup

[action_plugins]
action_plugins = $SHARED_DIR_PATH/ansible/plugins/action

# Production-specific settings
[prod]
# Production environment settings
inventory = $SHARED_DIR_PATH/ansible/inventory/dynamic_inventory.py
extra_vars = @ansible/group_vars/prod/main.yaml

# Cross-environment access settings
[cross_env]
# Allow access to other environments
inventory = $SHARED_DIR_PATH/ansible/inventory/dynamic_inventory.py
# No environment restriction - can access all environments
